<p align="center">
  <img src="https://cdn.discordapp.com/attachments/1462600282641793024/1465790667258069043/ChatGPT_Image_27_de_jan._de_2026_15_48_49.png?ex=697b0c30&is=6979bab0&hm=57ec6b6ffe7e3c306cd905a7d8511d4349f328c8d03bba659b133fc0616c5dbb&" alt="Orbyon Pay" width="280" />
</p>

<p align="center">
  <img src="src/assets/logos/orbyon-pay-logo.png" alt="Orbyon Pay" width="280" />
</p>

<h1 align="center">Orbyon Pay</h1>

<p align="center">
  <strong>Plataforma de Pagamentos Digitais para o Mercado Brasileiro</strong>
</p>

<p align="center">
  <img src="https://img.shields.io/badge/React-18.3-61DAFB?style=flat-square&logo=react&logoColor=white" alt="React" />
  <img src="https://img.shields.io/badge/TypeScript-5.6-3178C6?style=flat-square&logo=typescript&logoColor=white" alt="TypeScript" />
  <img src="https://img.shields.io/badge/Vite-6.0-646CFF?style=flat-square&logo=vite&logoColor=white" alt="Vite" />
  <img src="https://img.shields.io/badge/Tailwind-3.4-06B6D4?style=flat-square&logo=tailwindcss&logoColor=white" alt="Tailwind" />
  <img src="https://img.shields.io/badge/Supabase-Cloud-3FCF8E?style=flat-square&logo=supabase&logoColor=white" alt="Supabase" />
  <img src="https://img.shields.io/badge/Fastify-5.x-000000?style=flat-square&logo=fastify&logoColor=white" alt="Fastify" />
</p>

<p align="center">
  <img src="https://img.shields.io/badge/MultiPSP-Architecture-00D4AA?style=flat-square" alt="MultiPSP" />
  <img src="https://img.shields.io/badge/Pix_&_CartÃ£o-Payments-635BFF?style=flat-square" alt="Payments" />
  <img src="https://img.shields.io/badge/mTLS-Secured-00D4AA?style=flat-square" alt="mTLS" />
  <img src="https://img.shields.io/badge/PCI_DSS-Compliant-success?style=flat-square" alt="PCI DSS" />
  <img src="https://img.shields.io/badge/LGPD-Compliant-success?style=flat-square" alt="LGPD" />
</p>

---

## ğŸ“Œ ApresentaÃ§Ã£o

A **Orbyon Pay** Ã© uma plataforma de pagamentos digitais desenvolvida para atender vendedores, empreendedores e negÃ³cios que operam no ambiente digital brasileiro. Nossa soluÃ§Ã£o oferece processamento de pagamentos via **Pix** e **CartÃ£o de CrÃ©dito** atravÃ©s de uma **arquitetura MultiPSP** (Multi Payment Service Provider), permitindo integraÃ§Ã£o com mÃºltiplos provedores de pagamento de forma transparente, com foco em seguranÃ§a, velocidade, resiliÃªncia e experiÃªncia do usuÃ¡rio.

### O que a Orbyon Pay resolve?

O mercado de pagamentos digitais no Brasil ainda enfrenta desafios como taxas elevadas, processos burocrÃ¡ticos, suporte ineficiente e falta de transparÃªncia. A Orbyon Pay foi criada para oferecer uma alternativa moderna, acessÃ­vel e confiÃ¡vel para quem precisa receber pagamentos online.

### Para quem foi criada?

| Perfil | DescriÃ§Ã£o |
|--------|-----------|
| **Vendedores Digitais** | Infoprodutores, criadores de conteÃºdo, afiliados |
| **Empreendedores** | Lojas virtuais, prestadores de serviÃ§o, freelancers |
| **Empresas** | NegÃ³cios que precisam de uma soluÃ§Ã£o robusta e escalÃ¡vel |
| **Players e Creators** | Comunidades, gamers, streamers e produtores de conteÃºdo |

### Diferenciais

- âœ… **Arquitetura MultiPSP** â€” integraÃ§Ã£o com mÃºltiplos provedores para redundÃ¢ncia e melhores taxas
- âœ… **Taxas competitivas e transparentes** â€” sem surpresas ou cobranÃ§as ocultas
- âœ… **LiberaÃ§Ã£o rÃ¡pida de saldo** â€” opÃ§Ãµes flexÃ­veis de saque (Turbo e Flex)
- âœ… **Suporte humanizado** â€” atendimento real, nÃ£o robÃ´s
- âœ… **Painel completo** â€” gestÃ£o de vendas, relatÃ³rios, disputas e operaÃ§Ãµes financeiras
- âœ… **PolÃ­tica FairPlay PrÃ³-Vendedor** â€” proteÃ§Ã£o contra abusos de contestaÃ§Ã£o
- âœ… **Roteamento inteligente** â€” escolha automÃ¡tica do melhor PSP por transaÃ§Ã£o

---

## ğŸ› ï¸ Stack TecnolÃ³gica

### Frontend

| Tecnologia | VersÃ£o | PropÃ³sito |
|------------|--------|-----------|
| **React** | 18.3 | Biblioteca de UI reativa e componentizada |
| **TypeScript** | 5.6 | Tipagem estÃ¡tica para maior seguranÃ§a e manutenibilidade |
| **Vite** | 6.0 | Build tool de alta performance com HMR |
| **Tailwind CSS** | 3.4 | Framework CSS utilitÃ¡rio para design consistente |
| **shadcn/ui** | Latest | Componentes acessÃ­veis baseados em Radix UI |
| **React Query** | 5.x | Gerenciamento de estado de servidor e cache |
| **React Router** | 6.x | NavegaÃ§Ã£o SPA com lazy loading |
| **React Hook Form** | 7.x | FormulÃ¡rios performÃ¡ticos com validaÃ§Ã£o Zod |
| **Framer Motion** | Latest | AnimaÃ§Ãµes fluidas e micro-interaÃ§Ãµes |
| **Recharts** | 2.x | GrÃ¡ficos e visualizaÃ§Ã£o de dados |

### Backend & Database

| Tecnologia | PropÃ³sito |
|------------|-----------|
| **Supabase (PostgreSQL)** | Banco de dados relacional com RLS (Row Level Security) |
| **Supabase Auth** | AutenticaÃ§Ã£o JWT com 2FA e refresh automÃ¡tico |
| **Supabase Edge Functions** | FunÃ§Ãµes serverless em Deno para lÃ³gica de negÃ³cio |
| **Supabase Realtime** | AtualizaÃ§Ãµes em tempo real via WebSocket |
| **Supabase Storage** | Armazenamento seguro de documentos KYC |
| **Fastify** | API REST de alta performance (Node.js) |
| **Prisma** | ORM type-safe para interaÃ§Ã£o com banco de dados |
| **Zod** | ValidaÃ§Ã£o de schemas e sanitizaÃ§Ã£o de dados |

### Arquitetura MultiPSP (Multi Payment Service Provider)

A Orbyon Pay implementa uma arquitetura de mÃºltiplos provedores de pagamento, permitindo:

| Capacidade | DescriÃ§Ã£o |
|------------|----------|
| **RedundÃ¢ncia** | Failover automÃ¡tico entre PSPs em caso de indisponibilidade |
| **Roteamento Inteligente** | Escolha do melhor PSP por tipo de transaÃ§Ã£o, taxa ou disponibilidade |
| **NegociaÃ§Ã£o de Taxas** | Flexibilidade para negociar melhores condiÃ§Ãµes com cada provedor |
| **ExpansÃ£o Facilitada** | Novos PSPs podem ser adicionados via adaptadores padronizados |

### Modalidades de Pagamento

| Modalidade | Recursos |
|------------|----------|
| **Pix** | CobranÃ§a imediata, QR Code dinÃ¢mico, Pix Copia e Cola, Webhooks em tempo real, DevoluÃ§Ã£o |
| **CartÃ£o de CrÃ©dito** | TokenizaÃ§Ã£o segura, parcelamento (1-12x), antifraude integrado, 3D Secure 2.0 |
| **Infraestrutura** | mTLS (Mutual TLS), certificados por PSP, ambiente sandbox para testes |

### Infraestrutura & DevOps

| Tecnologia | PropÃ³sito |
|------------|-----------|
| **AWS EC2** | Hospedagem de API e Proxy |
| **Nginx** | Reverse proxy, SSL termination, load balancing |
| **PM2** | Process manager para Node.js com auto-restart |
| **GitHub Actions** | CI/CD automatizado para deploys |
| **Certbot** | Certificados SSL/TLS automÃ¡ticos (Let's Encrypt) |

### SeguranÃ§a & Compliance

| Tecnologia | PropÃ³sito |
|------------|-----------|
| **mTLS (Mutual TLS)** | AutenticaÃ§Ã£o mÃºtua para webhooks crÃ­ticos |
| **reCAPTCHA v3** | ProteÃ§Ã£o contra bots em formulÃ¡rios sensÃ­veis |
| **TOTP (2FA)** | AutenticaÃ§Ã£o de dois fatores via app |
| **AES-256-GCM** | Criptografia de dados sensÃ­veis |
| **SHA-256** | Hashing seguro de senhas e tokens |
| **HMAC** | ValidaÃ§Ã£o de assinaturas de webhooks |

### ComunicaÃ§Ã£o

| Provedor | Canal | Recursos |
|----------|-------|----------|
| **Infobip** | WhatsApp Business | Templates, bot automatizado, notificaÃ§Ãµes |
| **Zenvia** | E-mail | Alertas de login, notificaÃ§Ãµes transacionais, recuperaÃ§Ã£o de senha |
| **Zenvia** | SMS | OTP, alertas de seguranÃ§a, confirmaÃ§Ãµes |
| **Umbler Mail** | Atendimento | E-mail corporativo para suporte e comunicaÃ§Ã£o institucional |
---

## ğŸ—ï¸ Arquitetura da Plataforma

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          USUÃRIOS                             â”‚
â”‚               (Vendedores, Admins, Clientes)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FRONTEND (React SPA)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Dashboard  â”‚  â”‚   Landing   â”‚  â”‚   Checkout PÃºblico    â”‚  â”‚
â”‚  â”‚  (Merchant) â”‚  â”‚    Page     â”‚  â”‚   (Pix + CartÃ£o)      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â–¼                   â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Supabase Auth   â”‚  â”‚  Edge Functions   â”‚  â”‚    Fastify API    â”‚
â”‚    (JWT + 2FA)    â”‚  â”‚   (Serverless)    â”‚  â”‚    (REST API)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚                      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SUPABASE (PostgreSQL)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Profiles â”‚  â”‚   Orgs    â”‚  â”‚  Payments â”‚  â”‚   Audit   â”‚   â”‚
â”‚  â”‚  (Users)  â”‚  â”‚  (Tenant) â”‚  â”‚    (Tx)   â”‚  â”‚   Logs    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚            Row Level Security (RLS) + RBAC            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CAMADA MultiPSP                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              PSP Router (Roteamento Inteligente)        â”‚  â”‚
â”‚  â”‚   â€¢ SeleÃ§Ã£o por disponibilidade, taxa, tipo de Tx       â”‚  â”‚
â”‚  â”‚   â€¢ Failover automÃ¡tico entre provedores                â”‚  â”‚
â”‚  â”‚   â€¢ Circuit breaker por PSP                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                â”‚                              â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚       â–¼                        â–¼                        â–¼     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Adapter A  â”‚         â”‚  Adapter B  â”‚         â”‚ Adapter Nâ”‚ â”‚
â”‚  â”‚  (PSP #1)   â”‚         â”‚  (PSP #2)   â”‚         â”‚ (PSP #N) â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â–¼                        â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    PSP #1       â”‚    â”‚    PSP #2       â”‚    â”‚    PSP #N       â”‚
â”‚  (Pix + Card)   â”‚    â”‚  (Pix + Card)   â”‚    â”‚  (Pix + Card)   â”‚
â”‚   via mTLS      â”‚    â”‚   via mTLS      â”‚    â”‚   via mTLS      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ–¥ï¸ Frontend (Single Page Application)

Interface moderna construÃ­da com React e otimizada para performance:

- **Dashboard Merchant** â€” gestÃ£o completa de operaÃ§Ãµes, saldo, transaÃ§Ãµes e relatÃ³rios
- **Painel Administrativo** â€” controle total para equipe interna (KYC, suporte, antifraude)
- **Checkout PÃºblico** â€” pÃ¡ginas de pagamento otimizadas para conversÃ£o
- **Landing Page** â€” apresentaÃ§Ã£o institucional com tema dinÃ¢mico (Dark Premium)
- **Status Page** â€” transparÃªncia sobre disponibilidade dos serviÃ§os

### âš™ï¸ Backend (Edge Functions + API + MultiPSP)

Processamento distribuÃ­do entre funÃ§Ãµes serverless, API dedicada e camada de abstraÃ§Ã£o de PSPs:

| Componente | Responsabilidade |
|------------|------------------|
| **Edge Functions** | OperaÃ§Ãµes rÃ¡pidas: auth, webhooks, notificaÃ§Ãµes, validaÃ§Ãµes |
| **Fastify API** | LÃ³gica de negÃ³cio complexa, integraÃ§Ãµes financeiras, antifraude |
| **PSP Router** | Roteamento inteligente entre provedores de pagamento |
| **PSP Adapters** | Adaptadores padronizados para cada provedor (interface unificada) |
| **Proxy mTLS** | ComunicaÃ§Ã£o segura com PSPs (certificados mÃºtuos por provedor) |

### ğŸ—„ï¸ Banco de Dados

Estrutura multi-tenant com isolamento por organizaÃ§Ã£o:

```
profiles          â†’ Dados de usuÃ¡rio, KYC status, preferÃªncias
organizations     â†’ Tenants (empresas/vendedores)
memberships       â†’ VÃ­nculos RBAC (CEO, ADMIN, MERCHANT, SUPPORT)
transactions      â†’ HistÃ³rico de pagamentos Pix
credit_card_*     â†’ TransaÃ§Ãµes, tokens, disputas, ledger de cartÃ£o
balances          â†’ Saldo disponÃ­vel, bloqueado, pendente
disputes          â†’ ContestaÃ§Ãµes e evidÃªncias
audit_logs        â†’ Registro imutÃ¡vel de aÃ§Ãµes
```

---

## ğŸ—ºï¸ Mapa de OperaÃ§Ã£o â€” Arquitetura MultiPSP

### O que Ã© MultiPSP?

A arquitetura **MultiPSP** (Multi Payment Service Provider) permite que a Orbyon Pay se conecte a mÃºltiplos provedores de pagamento simultaneamente, oferecendo:

- **Alta disponibilidade** â€” se um PSP estiver indisponÃ­vel, o sistema roteia automaticamente para outro
- **OtimizaÃ§Ã£o de custos** â€” escolha do PSP com melhor taxa para cada tipo de transaÃ§Ã£o
- **Flexibilidade comercial** â€” negociaÃ§Ã£o independente com cada provedor
- **Escalabilidade** â€” novos PSPs podem ser adicionados sem alteraÃ§Ã£o no core da aplicaÃ§Ã£o

### VisÃ£o Geral do Fluxo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ORBYON PAY â€” MultiPSP                               â”‚
â”‚                        Mapa de OperaÃ§Ã£o Completo                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚   CLIENTE       â”‚
                              â”‚   (Pagador)     â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                  â–¼                  â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Checkout     â”‚  â”‚  Link de      â”‚  â”‚  QR Code      â”‚
            â”‚  Integrado    â”‚  â”‚  Pagamento    â”‚  â”‚  DinÃ¢mico     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                  â”‚                  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ORBYON PAY BACKEND                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    CAMADA DE ORQUESTRAÃ‡ÃƒO                           â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚  ValidaÃ§Ã£o  â”‚  â”‚ IdempotÃªnciaâ”‚  â”‚  Antifraude â”‚  â”‚   Ledger   â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  de Dados   â”‚  â”‚   (Keys)    â”‚  â”‚  (Scoring)  â”‚  â”‚  (Balance) â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                       â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    PSP ROUTER (Roteamento Inteligente)              â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ SeleÃ§Ã£o por disponibilidade (health check)               â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ SeleÃ§Ã£o por taxa (custo-benefÃ­cio)                       â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ SeleÃ§Ã£o por tipo de transaÃ§Ã£o (Pix/CartÃ£o)               â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ Circuit breaker por PSP (proteÃ§Ã£o contra falhas)         â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ Failover automÃ¡tico (retry em PSP alternativo)           â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                       â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    PSP ADAPTERS (Interface Unificada)               â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚  Adapter A  â”‚  â”‚  Adapter B  â”‚  â”‚  Adapter C  â”‚  â”‚ Adapter N  â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  (PSP #1)   â”‚  â”‚  (PSP #2)   â”‚  â”‚  (PSP #3)   â”‚  â”‚ (PSP #N)   â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                       â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    PROXY mTLS (AWS EC2)                             â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚  Certificados de ProduÃ§Ã£o por PSP (client.p12 + ca.pem)     â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  AutenticaÃ§Ã£o MÃºtua TLS 1.2+                                â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  Retry com Backoff Exponencial                              â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â–¼                            â–¼                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      PSP #1         â”‚    â”‚      PSP #2         â”‚    â”‚      PSP #N         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚     PIX       â”‚  â”‚    â”‚  â”‚     PIX       â”‚  â”‚    â”‚  â”‚     PIX       â”‚  â”‚
â”‚  â”‚  â€¢ CobranÃ§a   â”‚  â”‚    â”‚  â”‚  â€¢ CobranÃ§a   â”‚  â”‚    â”‚  â”‚  â€¢ CobranÃ§a   â”‚  â”‚
â”‚  â”‚  â€¢ QR Code    â”‚  â”‚    â”‚  â”‚  â€¢ QR Code    â”‚  â”‚    â”‚  â”‚  â€¢ QR Code    â”‚  â”‚
â”‚  â”‚  â€¢ DevoluÃ§Ã£o  â”‚  â”‚    â”‚  â”‚  â€¢ DevoluÃ§Ã£o  â”‚  â”‚    â”‚  â”‚  â€¢ DevoluÃ§Ã£o  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚    CARTÃƒO     â”‚  â”‚    â”‚  â”‚    CARTÃƒO     â”‚  â”‚    â”‚  â”‚    CARTÃƒO     â”‚  â”‚
â”‚  â”‚  â€¢ TokenizaÃ§Ã£oâ”‚  â”‚    â”‚  â”‚  â€¢ TokenizaÃ§Ã£oâ”‚  â”‚    â”‚  â”‚  â€¢ TokenizaÃ§Ã£oâ”‚  â”‚
â”‚  â”‚  â€¢ 3D Secure  â”‚  â”‚    â”‚  â”‚  â€¢ 3D Secure  â”‚  â”‚    â”‚  â”‚  â€¢ 3D Secure  â”‚  â”‚
â”‚  â”‚  â€¢ Antifraude â”‚  â”‚    â”‚  â”‚  â€¢ Antifraude â”‚  â”‚    â”‚  â”‚  â€¢ Antifraude â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚   WEBHOOKS      â”‚
                              â”‚   (Callbacks)   â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PROCESSAMENTO DE WEBHOOKS                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ValidaÃ§Ã£o de   â”‚  â”‚  IdempotÃªncia   â”‚  â”‚  AtualizaÃ§Ã£o de Status      â”‚  â”‚
â”‚  â”‚  Assinatura     â”‚  â”‚  (webhook_inbox)â”‚  â”‚  (transactions + balances)  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                       â”‚                                     â”‚
â”‚                                       â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    NOTIFICAÃ‡Ã•ES                                     â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚    â”‚
â”‚  â”‚  â”‚  WhatsApp   â”‚  â”‚   E-mail    â”‚  â”‚    SMS      â”‚                  â”‚    â”‚
â”‚  â”‚  â”‚  (Infobip)  â”‚  â”‚  (Zenvia)   â”‚  â”‚  (Zenvia)   â”‚                  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Como Funciona o Roteamento MultiPSP

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FLUXO DE DECISÃƒO DO ROUTER                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚  Nova TransaÃ§Ã£o     â”‚
                         â”‚  (Pix ou CartÃ£o)    â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚  1. Health Check    â”‚
                         â”‚  Quais PSPs estÃ£o   â”‚
                         â”‚  disponÃ­veis?       â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼               â–¼               â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ PSP #1   â”‚   â”‚ PSP #2   â”‚   â”‚ PSP #3   â”‚
              â”‚ âœ… Online â”‚   â”‚ âŒ Offlineâ”‚   â”‚ âœ… Online â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                               â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚  2. SeleÃ§Ã£o por     â”‚
                         â”‚  CritÃ©rio           â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â–¼                     â–¼                     â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  Por Taxa       â”‚   â”‚  Por Tipo       â”‚   â”‚  Por Prioridade â”‚
     â”‚  (menor custo)  â”‚   â”‚  (Pix/CartÃ£o)   â”‚   â”‚  (configurado)  â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚  3. Executa no PSP  â”‚
                         â”‚  Selecionado        â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                               â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  âœ… Sucesso      â”‚             â”‚  âŒ Falha        â”‚
           â”‚  Retorna txid   â”‚             â”‚  Tenta prÃ³ximo  â”‚
           â”‚  e QR Code      â”‚             â”‚  PSP disponÃ­vel â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                    â”‚
                                                    â–¼
                                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                           â”‚  Failover para  â”‚
                                           â”‚  PSP alternativoâ”‚
                                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Fluxo de Pagamento Pix (MultiPSP)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cliente  â”‚â”€â”€â”€â–¶â”‚ Orbyon Pay   â”‚â”€â”€â”€â–¶â”‚ PSP Router   â”‚â”€â”€â”€â–¶â”‚  PSP Ativo   â”‚
â”‚ (Payer)  â”‚    â”‚ (Backend)    â”‚    â”‚ (SeleÃ§Ã£o)    â”‚    â”‚  (API Pix)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                 â”‚                   â”‚                   â”‚
     â”‚  1. Solicita    â”‚                   â”‚                   â”‚
     â”‚     pagamento   â”‚                   â”‚                   â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                   â”‚                   â”‚
     â”‚                 â”‚  2. Seleciona     â”‚                   â”‚
     â”‚                 â”‚     melhor PSP    â”‚                   â”‚
     â”‚                 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                   â”‚
     â”‚                 â”‚                   â”‚  3. POST /cob     â”‚
     â”‚                 â”‚                   â”‚   (mTLS auth)     â”‚
     â”‚                 â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
     â”‚                 â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  4. txid + QR     â”‚
     â”‚                 â”‚                   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚                 â”‚  5. QR Code       â”‚                   â”‚
     â”‚                 â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚
     â”‚  6. Exibe QR    â”‚                   â”‚                   â”‚
     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚
     â”‚  7. Paga via    â”‚                   â”‚                   â”‚
     â”‚     app banco   â”‚                   â”‚                   â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶
     â”‚                 â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  8. Webhook       â”‚
     â”‚                 â”‚                   â”‚     PIX_RECEIVED  â”‚
     â”‚                 â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚                 â”‚                   â”‚                   â”‚
     â”‚                 â”‚  9. Atualiza      â”‚                   â”‚
     â”‚                 â”‚     status +      â”‚                   â”‚
     â”‚                 â”‚     saldo         â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚
     â”‚  10. Notifica   â”‚                   â”‚                   â”‚
     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚                   â”‚
```

### Fluxo de Pagamento CartÃ£o de CrÃ©dito (MultiPSP)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cliente  â”‚â”€â”€â”€â–¶â”‚ Orbyon Pay   â”‚â”€â”€â”€â–¶â”‚ PSP Router   â”‚â”€â”€â”€â–¶â”‚  PSP Ativo   â”‚
â”‚ (Payer)  â”‚    â”‚ (Backend)    â”‚    â”‚ (SeleÃ§Ã£o)    â”‚    â”‚  (API Card)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                 â”‚                   â”‚                   â”‚
     â”‚  1. Dados do    â”‚                   â”‚                   â”‚
     â”‚     cartÃ£o      â”‚                   â”‚                   â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                   â”‚                   â”‚
     â”‚                 â”‚  2. Seleciona     â”‚                   â”‚
     â”‚                 â”‚     melhor PSP    â”‚                   â”‚
     â”‚                 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                   â”‚
     â”‚                 â”‚                   â”‚  3. Tokeniza      â”‚
     â”‚                 â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
     â”‚                 â”‚                   â”‚  4. payment_token â”‚
     â”‚                 â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚                 â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  5. Autoriza      â”‚
     â”‚                 â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
     â”‚                 â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  6. Resposta      â”‚
     â”‚                 â”‚                   â”‚     (approved/    â”‚
     â”‚                 â”‚                   â”‚      declined)    â”‚
     â”‚                 â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚                 â”‚                   â”‚                   â”‚
     â”‚  7. Resultado   â”‚                   â”‚                   â”‚
     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚
     â”‚                 â”‚  8. Webhook       â”‚                   â”‚
     â”‚                 â”‚     (status)      â”‚                   â”‚
     â”‚                 â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
```

### Interface PadrÃ£o do PSP Adapter

Cada PSP implementa a mesma interface, garantindo intercambiabilidade:

| MÃ©todo | DescriÃ§Ã£o | Retorno |
|--------|-----------|---------|
| `createPixCharge()` | Cria cobranÃ§a Pix | `{ txid, qrCode, pixCopiaECola, expiresAt }` |
| `getPixCharge()` | Consulta status da cobranÃ§a | `{ status, paidAt, amount }` |
| `refundPix()` | Solicita devoluÃ§Ã£o | `{ refundId, status }` |
| `tokenizeCard()` | Tokeniza dados do cartÃ£o | `{ paymentToken, brand, last4 }` |
| `authorizeCard()` | Autoriza pagamento | `{ chargeId, status, authCode }` |
| `captureCard()` | Captura pagamento autorizado | `{ status }` |
| `refundCard()` | Estorna pagamento | `{ refundId, status }` |
| `healthCheck()` | Verifica disponibilidade | `{ available: boolean, latency }` |

### ConfiguraÃ§Ã£o mTLS por PSP

| Componente | DescriÃ§Ã£o |
|------------|-----------|
| **Certificados** | Cada PSP possui seu prÃ³prio par de certificados (client.p12 + ca.pem) |
| **Isolamento** | Certificados armazenados em diretÃ³rios separados por PSP |
| **RotaÃ§Ã£o** | Suporte a rotaÃ§Ã£o de certificados sem downtime |
| **Proxy** | Nginx + Node.js em EC2 com PM2 |
| **Protocolo** | TLS 1.2+ com autenticaÃ§Ã£o mÃºtua |

### Webhooks Processados (Normalizados)

| Evento Normalizado | DescriÃ§Ã£o | AÃ§Ã£o na Orbyon Pay |
|-------------------|-----------|-------------------|
| `payment.received` | Pagamento Pix confirmado | Credita saldo, notifica vendedor |
| `payment.refunded` | DevoluÃ§Ã£o processada | Debita saldo, registra devoluÃ§Ã£o |
| `card.approved` | CartÃ£o autorizado/capturado | Agenda liberaÃ§Ã£o de saldo |
| `card.declined` | CartÃ£o recusado | Marca como falha, notifica cliente |
| `card.refunded` | Estorno processado | Ajusta saldo |
| `card.chargeback` | ContestaÃ§Ã£o recebida | Abre disputa, bloqueia valor |

### GestÃ£o de Saldo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         LEDGER DE SALDO (Double-Entry)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚  SALDO BRUTO    â”‚    â”‚ SALDO DISPONÃVELâ”‚    â”‚ SALDO BLOQUEADO â”‚         â”‚
â”‚   â”‚  (Recebido)     â”‚â”€â”€â”€â–¶â”‚  (Liberado)     â”‚    â”‚  (Disputas)     â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚          â”‚                       â”‚                      â”‚                   â”‚
â”‚          â”‚   PerÃ­odo de          â”‚   Saque              â”‚   ResoluÃ§Ã£o       â”‚
â”‚          â”‚   LiberaÃ§Ã£o           â”‚   (Turbo/Flex)       â”‚   de Disputa      â”‚
â”‚          â”‚   (D+14/D+30)         â”‚                      â”‚                   â”‚
â”‚          â–¼                       â–¼                      â–¼                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚  Taxa Orbyon    â”‚    â”‚  Conta BancÃ¡ria â”‚    â”‚  LiberaÃ§Ã£o ou   â”‚         â”‚
â”‚   â”‚  (Deduzida)     â”‚    â”‚  do Vendedor    â”‚    â”‚  Perda          â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Ciclo de Vida de uma TransaÃ§Ã£o

| Status | DescriÃ§Ã£o | PrÃ³ximos Estados |
|--------|-----------|------------------|
| `pending` | Aguardando pagamento | `paid`, `expired`, `cancelled` |
| `paid` | Pagamento confirmado | `available`, `disputed` |
| `available` | Saldo liberado para saque | `withdrawn` |
| `disputed` | Em contestaÃ§Ã£o | `resolved_seller`, `resolved_buyer` |
| `withdrawn` | Saldo sacado | (final) |
| `refunded` | Devolvido ao pagador | (final) |
| `expired` | Expirou sem pagamento | (final) |

### Vantagens da Arquitetura MultiPSP

| BenefÃ­cio | DescriÃ§Ã£o |
|-----------|-----------|
| **ResiliÃªncia** | Falha em um PSP nÃ£o afeta a operaÃ§Ã£o â€” failover automÃ¡tico |
| **NegociaÃ§Ã£o** | Poder de barganha com mÃºltiplos provedores |
| **OtimizaÃ§Ã£o** | Roteamento por menor taxa ou melhor performance |
| **Compliance** | Cada PSP pode ter regras especÃ­ficas de compliance |
| **Escalabilidade** | Adicionar novos PSPs sem refatorar o core |
| **IndependÃªncia** | NÃ£o hÃ¡ lock-in com nenhum provedor especÃ­fico |

---

## ğŸ” SeguranÃ§a e ProteÃ§Ã£o de Dados

### Camadas de ProteÃ§Ã£o

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. WAF + DDoS Protection (Cloudflare)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2. SSL/TLS + mTLS (Nginx + Certbot)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  3. reCAPTCHA v3 (ProteÃ§Ã£o contra bots)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  4. JWT + 2FA (AutenticaÃ§Ã£o e sessÃµes)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  5. RBAC + RLS (Controle de acesso granular)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  6. Antifraude (Regras de velocidade, blocklist, scoring)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  7. Criptografia AES-256 (Dados sensÃ­veis em repouso)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  8. Audit Trail (Logs imutÃ¡veis com request_id)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### PrÃ¡ticas Implementadas

| Ãrea | ImplementaÃ§Ã£o |
|------|---------------|
| **AutenticaÃ§Ã£o** | JWT com refresh automÃ¡tico, 2FA via TOTP, lockout progressivo |
| **AutorizaÃ§Ã£o** | RBAC multi-tenant com isolamento por `org_id` |
| **Dados de CartÃ£o** | TokenizaÃ§Ã£o via PSP, nunca armazenamos PAN completo |
| **ComunicaÃ§Ã£o** | HTTPS obrigatÃ³rio, mTLS para webhooks crÃ­ticos |
| **ValidaÃ§Ã£o** | Schemas Zod em todas as entradas, sanitizaÃ§Ã£o de dados |
| **IdempotÃªncia** | Chaves de idempotÃªncia em transaÃ§Ãµes e webhooks |
| **Auditoria** | Logs imutÃ¡veis com `request_id` para rastreabilidade |

### Conformidade

- âœ… **PCI DSS** â€” PadrÃµes de seguranÃ§a para dados de cartÃ£o
- âœ… **LGPD** â€” Lei Geral de ProteÃ§Ã£o de Dados Pessoais
- âœ… **BACEN** â€” Normas do Banco Central para arranjos de pagamento
- âœ… **3D Secure 2.0** â€” AutenticaÃ§Ã£o forte em transaÃ§Ãµes de cartÃ£o via PSPs integrados

---

## ğŸ§¾ Compliance e Conformidade

### PrevenÃ§Ã£o Ã  Lavagem de Dinheiro (AML)

- Monitoramento de transaÃ§Ãµes suspeitas em tempo real
- Regras de velocidade e limites por perfil de risco
- Bloqueio preventivo e comunicaÃ§Ã£o Ã s autoridades quando aplicÃ¡vel
- RelatÃ³rios de atividades atÃ­picas

### VerificaÃ§Ã£o de Identidade (KYC/KYB)

| Tipo | Documentos Exigidos |
|------|---------------------|
| **Pessoa FÃ­sica (16+)** | Documento de identidade com foto, selfie, comprovante de endereÃ§o |
| **Menor (16-18 anos)** | Documentos do menor + formulÃ¡rio de consentimento do responsÃ¡vel |
| **Pessoa JurÃ­dica** | Contrato Social, CartÃ£o CNPJ, CCMEI (se MEI) |

### Auditoria e Rastreabilidade

- Trilha de auditoria completa com `request_id` Ãºnico
- HistÃ³rico imutÃ¡vel de todas as operaÃ§Ãµes
- Logs de acesso e alteraÃ§Ãµes de configuraÃ§Ã£o
- RelatÃ³rios para conformidade regulatÃ³ria

---

## ğŸ“œ Regras de Uso

### Atividades Permitidas

- âœ… ComercializaÃ§Ã£o de produtos e serviÃ§os digitais legÃ­timos
- âœ… Infoprodutos, cursos, mentorias, consultorias
- âœ… Assinaturas e recorrÃªncias
- âœ… ServiÃ§os de tecnologia e software

### Atividades Proibidas

- âŒ Fraudes, golpes ou esquemas financeiros ilÃ­citos
- âŒ Lavagem de dinheiro ou financiamento de atividades ilegais
- âŒ Produtos ou serviÃ§os proibidos por lei brasileira
- âŒ Uso de identidades falsas ou documentos fraudulentos
- âŒ Abuso de mecanismos de contestaÃ§Ã£o ou estorno

### ConsequÃªncias de ViolaÃ§Ãµes

1. Bloqueio temporÃ¡rio da conta para investigaÃ§Ã£o
2. RetenÃ§Ã£o de saldo conforme anÃ¡lise
3. ComunicaÃ§Ã£o Ã s autoridades quando aplicÃ¡vel
4. Encerramento definitivo do relacionamento comercial

---

## ğŸ¤ Compromisso com Parceiros e Clientes

### TransparÃªncia Operacional

- Taxas e prazos claros, sem cobranÃ§as ocultas
- Status Page pÃºblica para acompanhamento de serviÃ§os
- ComunicaÃ§Ã£o proativa sobre mudanÃ§as e atualizaÃ§Ãµes

### Suporte

- Atendimento humanizado via WhatsApp e tickets
- Tempo de resposta mÃ©dio: 2 horas (horÃ¡rio comercial)
- Escalonamento automÃ¡tico para casos crÃ­ticos

### SLA de Disponibilidade

| Componente | Meta |
|------------|------|
| **API de Pagamentos** | 99.9% uptime |
| **Dashboard** | 99.5% uptime |
| **Webhooks** | Retry automÃ¡tico com backoff exponencial |

---

## ğŸš€ VisÃ£o de Futuro

### Funcionalidades Implementadas

- âœ… **Arquitetura MultiPSP** â€” IntegraÃ§Ã£o com mÃºltiplos provedores de pagamento
- âœ… **Pix InstantÃ¢neo** â€” CobranÃ§a imediata com QR Code dinÃ¢mico
- âœ… **CartÃ£o de CrÃ©dito** â€” TokenizaÃ§Ã£o, parcelamento e 3D Secure
- âœ… **Ledger Double-Entry** â€” GestÃ£o de saldo com auditoria completa
- âœ… **Sistema de Disputas** â€” GestÃ£o de chargebacks e contestaÃ§Ãµes
- âœ… **KYC/KYB Completo** â€” VerificaÃ§Ã£o de identidade para PF e PJ
- âœ… **Painel Administrativo** â€” GestÃ£o completa de operaÃ§Ãµes
- âœ… **Webhooks Resilientes** â€” Processamento idempotente com retry

### Roadmap

- ğŸ”œ **Pix Parcelado** â€” Parcelamento via Pix com antecipaÃ§Ã£o
- ğŸ”œ **Split de Pagamentos** â€” DivisÃ£o automÃ¡tica entre vendedores
- ğŸ”œ **Marketplace** â€” Suporte a mÃºltiplos vendedores
- ğŸ”œ **SDK Mobile** â€” IntegraÃ§Ã£o nativa para apps iOS/Android
- ğŸ”œ **Open Finance** â€” IntegraÃ§Ã£o com ecossistema bancÃ¡rio aberto
- ğŸ”œ **RecorrÃªncia** â€” Assinaturas e cobranÃ§as recorrentes

### Posicionamento

Foco no segmento de vendedores digitais e creators, com diferenciaÃ§Ã£o por:

- Arquitetura MultiPSP para resiliÃªncia e melhores taxas
- Qualidade tÃ©cnica e seguranÃ§a enterprise-grade
- Suporte humanizado e transparÃªncia
- PolÃ­tica FairPlay prÃ³-vendedor
- Taxas competitivas sem surpresas

---

## ğŸ“ Contato

| Canal | EndereÃ§o |
|-------|----------|
| **Suporte** | suporte@orbyonpay.com |
| **Comercial** | comercial@orbyonpay.com |
| **DPO (ProteÃ§Ã£o de Dados)** | dpo@orbyonpay.com |
| **JurÃ­dico** | juridico@orbyonpay.com |
| **Tutela (Menores)** | tutela@orbyonpay.com |

---

## ğŸ“„ Documentos Legais

- [Termos de Uso](https://orbyonpay.com/terms)
- [PolÃ­tica de Privacidade](https://orbyonpay.com/privacy)
- [PolÃ­tica FairPlay](https://orbyonpay.com/fairplay)
- [Compliance e SeguranÃ§a](https://orbyonpay.com/compliance)
- [Status dos ServiÃ§os](https://orbyonpay.com/status)

---

<p align="center">
  <strong>Orbyon Pay</strong> â€” Um produto da <strong>ORBYON PAY LTDA</strong>
</p>

<p align="center">
  CNPJ: 64.387.452/0001-50 | MaringÃ¡/PR, Brasil
</p>

<p align="center">
  <sub>Documento atualizado em Janeiro de 2026</sub>
</p>
